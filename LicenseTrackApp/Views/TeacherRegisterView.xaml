<?xml version="1.0" encoding="utf-8" ?>
<ContentPage
    x:Class="LicenseTrackApp.Views.TeacherRegisterView"
    xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
    xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
    xmlns:viewmodels="clr-namespace:LicenseTrackApp.ViewModels"
    Title="הרשמת מורה"
    x:DataType="viewmodels:TeacheRegisterViewModel"
    BackgroundColor="#F5F9FC">

    <Grid>
        <!-- רקע דקורטיבי -->
        <BoxView 
            Grid.Row="0"
            HeightRequest="200"
            HorizontalOptions="Fill"
            VerticalOptions="Start"
            BackgroundColor="#1A75BC"
            Opacity="0.9" />

        <Path Fill="#1C8AD9" 
              Opacity="0.3"
              Data="M0,150 C150,200 300,110 400,180 L400,0 L0,0 Z" />

        <ScrollView>
            <Grid Padding="20,15">
                <!-- כותרת המסך -->
                <VerticalStackLayout Grid.Row="0" Margin="0,0,0,20">
                    <Label 
                        Text="הרשמת מורה חדש"
                        FontSize="28"
                        FontAttributes="Bold"
                        TextColor="#FFFFFF"
                        HorizontalOptions="Center"
                        Margin="0,20,0,10" />

                    <Label 
                        Text="ברוכים הבאים למערכת שיעורי נהיגה"
                        FontSize="16"
                        TextColor="#E5E7F1"
                        HorizontalOptions="Center"
                        Margin="0,0,0,10" />
                </VerticalStackLayout>

                <!-- טופס הרשמה במסגרת לבנה -->
                <Frame 
                    Grid.Row="1" 
                    BackgroundColor="#FFFFFF"
                    CornerRadius="20"
                    HasShadow="True"
                    BorderColor="#E5E7F1"
                    Padding="20"
                    Margin="0,70,0,20">

                    <VerticalStackLayout Spacing="15" IsEnabled="{Binding NotInServerCall}">
                        <!-- אזור התמונה -->
                        <Frame
                            Margin="0,5,0,15"
                            Padding="0"
                            BackgroundColor="#F0F5FF"
                            BorderColor="#1A75BC"
                            CornerRadius="15"
                            HasShadow="False">
                            <Grid RowSpacing="10" Padding="10">
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="*" />
                                    <RowDefinition Height="Auto" />
                                </Grid.RowDefinitions>

                                <Image
                                    x:Name="theImageBug"
                                    Grid.Row="0"
                                    HeightRequest="150"
                                    WidthRequest="150"
                                    Aspect="AspectFill"
                                    HorizontalOptions="Center"
                                    Source="{Binding PhotoURL}" />

                                <Button
                                    Grid.Row="1"
                                    Text="העלה תמונה"
                                    Command="{Binding UploadPhotoCommand}"
                                    BackgroundColor="#1A75BC"
                                    TextColor="White"
                                    CornerRadius="10"
                                    FontSize="14"
                                    HeightRequest="40"
                                    HorizontalOptions="Center" />
                            </Grid>
                        </Frame>

                        <!-- מידע אישי -->
                        <Label 
                            Text="פרטים אישיים" 
                            FontSize="18"
                            FontAttributes="Bold"
                            TextColor="#2c3e50"
                            Margin="5,0,5,10" />

                        <!-- שם פרטי -->
                        <VerticalStackLayout Spacing="5">
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*" />
                                    <ColumnDefinition Width="*" />
                                </Grid.ColumnDefinitions>
                                <Label
                                    Grid.Column="0"
                                    Text="שם פרטי"
                                    FontSize="14"
                                    TextColor="#6D7B92"
                                    FlowDirection="RightToLeft" />
                                <Label
                                    Grid.Column="1"
                                    IsVisible="{Binding ShowNameError}"
                                    Text="{Binding NameError}"
                                    TextColor="#E53E3E"
                                    FontSize="12"
                                    HorizontalOptions="End" />
                            </Grid>

                            <Frame
                                Padding="15,0"
                                CornerRadius="10"
                                BorderColor="#E5E7F1"
                                HasShadow="False"
                                HeightRequest="50">

                                <Entry
                                    Placeholder="הכנס שם פרטי"
                                    PlaceholderColor="#A0AEC0"
                                    Text="{Binding Name}"
                                    BackgroundColor="Transparent"
                                    FlowDirection="RightToLeft" />
                            </Frame>
                        </VerticalStackLayout>

                        <!-- שם משפחה -->
                        <VerticalStackLayout Spacing="5">
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*" />
                                    <ColumnDefinition Width="*" />
                                </Grid.ColumnDefinitions>
                                <Label
                                    Grid.Column="0"
                                    Text="שם משפחה"
                                    FontSize="14"
                                    TextColor="#6D7B92"
                                    FlowDirection="RightToLeft" />
                                <Label
                                    Grid.Column="1"
                                    IsVisible="{Binding ShowLastNameError}"
                                    Text="{Binding LastNameError}"
                                    TextColor="#E53E3E"
                                    FontSize="12"
                                    HorizontalOptions="End" />
                            </Grid>

                            <Frame
                                Padding="15,0"
                                CornerRadius="10"
                                BorderColor="#E5E7F1"
                                HasShadow="False"
                                HeightRequest="50">

                                <Entry
                                    Placeholder="הכנס שם משפחה"
                                    PlaceholderColor="#A0AEC0"
                                    Text="{Binding LastName}"
                                    BackgroundColor="Transparent"
                                    FlowDirection="RightToLeft" />
                            </Frame>
                        </VerticalStackLayout>

                        <!-- אימייל -->
                        <VerticalStackLayout Spacing="5">
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*" />
                                    <ColumnDefinition Width="*" />
                                </Grid.ColumnDefinitions>
                                <Label
                                    Grid.Column="0"
                                    Text="אימייל"
                                    FontSize="14"
                                    TextColor="#6D7B92"
                                    FlowDirection="RightToLeft" />
                                <Label
                                    Grid.Column="1"
                                    IsVisible="{Binding ShowEmailError}"
                                    Text="{Binding EmailError}"
                                    TextColor="#E53E3E"
                                    FontSize="12"
                                    HorizontalOptions="End" />
                            </Grid>

                            <Frame
                                Padding="15,0"
                                CornerRadius="10"
                                BorderColor="#E5E7F1"
                                HasShadow="False"
                                HeightRequest="50">

                                <Entry
                                    Placeholder="הכנס כתובת אימייל"
                                    PlaceholderColor="#A0AEC0"
                                    Keyboard="Email"
                                    Text="{Binding Email}"
                                    BackgroundColor="Transparent"
                                    FlowDirection="RightToLeft" />
                            </Frame>
                        </VerticalStackLayout>

                        <!-- סיסמה -->
                        <VerticalStackLayout Spacing="5">
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*" />
                                    <ColumnDefinition Width="*" />
                                </Grid.ColumnDefinitions>
                                <Label
                                    Grid.Column="0"
                                    Text="סיסמה"
                                    FontSize="14"
                                    TextColor="#6D7B92"
                                    FlowDirection="RightToLeft" />
                                <Label
                                    Grid.Column="1"
                                    IsVisible="{Binding ShowPasswordError}"
                                    Text="{Binding PasswordError}"
                                    TextColor="#E53E3E"
                                    FontSize="12"
                                    HorizontalOptions="End" />
                            </Grid>

                            <Frame
                                Padding="15,0"
                                CornerRadius="10"
                                BorderColor="#E5E7F1"
                                HasShadow="False"
                                HeightRequest="50">

                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="*" />
                                        <ColumnDefinition Width="40" />
                                    </Grid.ColumnDefinitions>

                                    <Entry
                                        Grid.Column="0"
                                        Placeholder="הכנס סיסמה"
                                        PlaceholderColor="#A0AEC0"
                                        IsPassword="{Binding IsPassword}"
                                        Text="{Binding Password}"
                                        BackgroundColor="Transparent"
                                        FlowDirection="RightToLeft" />

                                    <ImageButton
                                        Grid.Column="1"
                                        Command="{Binding ShowPasswordCommand}"
                                        HeightRequest="25"
                                        WidthRequest="25"
                                        Source="passwordeye.jpg"
                                        BackgroundColor="Transparent"
                                        Aspect="AspectFit" />
                                </Grid>
                            </Frame>
                        </VerticalStackLayout>

                        <!-- מידע מקצועי -->
                        <Label 
                            Text="פרטים מקצועיים" 
                            FontSize="18"
                            FontAttributes="Bold"
                            TextColor="#2c3e50"
                            Margin="5,10,5,10" />

                        <!-- אזור לימוד -->
                        <VerticalStackLayout Spacing="5">
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*" />
                                    <ColumnDefinition Width="*" />
                                </Grid.ColumnDefinitions>
                                <Label
                                    Grid.Column="0"
                                    Text="אזור לימוד"
                                    FontSize="14"
                                    TextColor="#6D7B92"
                                    FlowDirection="RightToLeft" />
                                <Label
                                    Grid.Column="1"
                                    IsVisible="{Binding ShowTeachingAreaError}"
                                    Text="{Binding TeachingAreaError}"
                                    TextColor="#E53E3E"
                                    FontSize="12"
                                    HorizontalOptions="End" />
                            </Grid>

                            <Frame
                                Padding="15,0"
                                CornerRadius="10"
                                BorderColor="#E5E7F1"
                                HasShadow="False"
                                HeightRequest="50">

                                <Entry
                                    Placeholder="הכנס אזור לימוד"
                                    PlaceholderColor="#A0AEC0"
                                    Text="{Binding TeachingArea}"
                                    BackgroundColor="Transparent"
                                    FlowDirection="RightToLeft" />
                            </Frame>
                        </VerticalStackLayout>

                        <!-- שם בית ספר -->
                        <VerticalStackLayout Spacing="5">
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*" />
                                    <ColumnDefinition Width="*" />
                                </Grid.ColumnDefinitions>
                                <Label
                                    Grid.Column="0"
                                    Text="שם בית ספר"
                                    FontSize="14"
                                    TextColor="#6D7B92"
                                    FlowDirection="RightToLeft" />
                                <Label
                                    Grid.Column="1"
                                    IsVisible="{Binding ShowSchoolNameError}"
                                    Text="{Binding SchoolNameError}"
                                    TextColor="#E53E3E"
                                    FontSize="12"
                                    HorizontalOptions="End" />
                            </Grid>

                            <Frame
                                Padding="15,0"
                                CornerRadius="10"
                                BorderColor="#E5E7F1"
                                HasShadow="False"
                                HeightRequest="50">

                                <Entry
                                    Placeholder="הכנס שם בית ספר"
                                    PlaceholderColor="#A0AEC0"
                                    Text="{Binding SchoolName}"
                                    BackgroundColor="Transparent"
                                    FlowDirection="RightToLeft" />
                            </Frame>
                        </VerticalStackLayout>

                        <!-- סוג הרכב -->
                        <VerticalStackLayout Spacing="5">
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*" />
                                    <ColumnDefinition Width="*" />
                                </Grid.ColumnDefinitions>
                                <Label
                                    Grid.Column="0"
                                    Text="סוג הרכב"
                                    FontSize="14"
                                    TextColor="#6D7B92"
                                    FlowDirection="RightToLeft" />
                                <Label
                                    Grid.Column="1"
                                    IsVisible="{Binding ShowVehicleTypeError}"
                                    Text="{Binding VehicleTypeError}"
                                    TextColor="#E53E3E"
                                    FontSize="12"
                                    HorizontalOptions="End" />
                            </Grid>

                            <Frame
                                Padding="15,0"
                                CornerRadius="10"
                                BorderColor="#E5E7F1"
                                HasShadow="False"
                                HeightRequest="50">

                                <Entry
                                    Placeholder="הכנס סוג הרכב"
                                    PlaceholderColor="#A0AEC0"
                                    Text="{Binding VehicleType}"
                                    BackgroundColor="Transparent"
                                    FlowDirection="RightToLeft" />
                            </Frame>
                        </VerticalStackLayout>

                        <!-- סוג תיבת הילוכים -->
                        <VerticalStackLayout Spacing="5">
                            <Label
                                Text="סוג תיבת הילוכים"
                                FontSize="14"
                                TextColor="#6D7B92"
                                FlowDirection="RightToLeft"
                                Margin="5,0,0,3" />

                            <Frame
                                Padding="15,5"
                                CornerRadius="10"
                                BorderColor="#E5E7F1"
                                HasShadow="False"
                                BackgroundColor="#F0F5FF">

                                <VerticalStackLayout 
                                    RadioButtonGroup.GroupName="Manual" 
                                    RadioButtonGroup.SelectedValue="{Binding ManualButton}"
                                    Spacing="10">
                                    <RadioButton 
                                        Content="ידני" 
                                        Value="0" 
                                        TextColor="#34495e"
                                        FontSize="16" />
                                    <RadioButton 
                                        Content="אוטומט" 
                                        Value="1" 
                                        TextColor="#34495e"
                                        FontSize="16" />
                                </VerticalStackLayout>
                            </Frame>
                        </VerticalStackLayout>

                        <!-- כפתורי הרשמה וביטול -->
                        <Grid Margin="0,15,0,10" ColumnSpacing="15">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*" />
                                <ColumnDefinition Width="*" />
                            </Grid.ColumnDefinitions>

                            <Button
                                Grid.Column="1"
                                Text="הרשמה"
                                Command="{Binding RegisterCommand}"
                                IsEnabled="{Binding NotInServerCall}"
                                BackgroundColor="#1A75BC"
                                TextColor="White"
                                CornerRadius="10"
                                HeightRequest="50"
                                FontAttributes="Bold"
                                FontSize="16" />

                            <Button
                                Grid.Column="0"
                                Text="ביטול"
                                Command="{Binding CancelCommand}"
                                IsEnabled="{Binding NotInServerCall}"
                                BackgroundColor="#E5E7F1"
                                TextColor="#6D7B92"
                                CornerRadius="10"
                                HeightRequest="50"
                                FontSize="16" />
                        </Grid>

                        <!-- קישור להרשמת תלמיד -->
                        <Frame
                            BackgroundColor="#F0F5FF"
                            CornerRadius="10"
                            HasShadow="False"
                            BorderColor="#1C8AD9"
                            Padding="10"
                            Margin="0,5,0,10">

                            <Label 
                                Text="להרשמה כתלמיד/ה לחץ כאן"
                                TextColor="#1A75BC"
                                FontSize="14"
                                HorizontalOptions="Center"
                                VerticalOptions="Center" 
                                IsEnabled="{Binding NotInServerCall}">

                                <Label.GestureRecognizers>
                                    <TapGestureRecognizer Command="{Binding StudentRegisterCommand}"/>
                                </Label.GestureRecognizers>
                            </Label>
                        </Frame>
                    </VerticalStackLayout>
                </Frame>
            </Grid>
        </ScrollView>

        <!--  אינדיקטור טעינה מרוכז  -->
        <Frame 
            BackgroundColor="#80000000"
            IsVisible="{Binding InServerCall}"
            HorizontalOptions="Fill"
            VerticalOptions="Fill"
            HasShadow="False"
            Padding="0"
            Opacity="0.7">
            <VerticalStackLayout
                HorizontalOptions="Center"
                VerticalOptions="Center">
                <Frame
                    BackgroundColor="#ffffff"
                    CornerRadius="12"
                    HeightRequest="100"
                    WidthRequest="100"
                    HasShadow="True">
                    <VerticalStackLayout
                        HorizontalOptions="Center"
                        VerticalOptions="Center"
                        Spacing="10">
                        <ActivityIndicator
                            HeightRequest="40"
                            WidthRequest="40"
                            IsRunning="{Binding InServerCall}"
                            Color="#1A75BC" />
                        <Label
                            Text="טוען..."
                            TextColor="#34495e"
                            HorizontalOptions="Center" />
                    </VerticalStackLayout>
                </Frame>
            </VerticalStackLayout>
        </Frame>
    </Grid>
</ContentPage>